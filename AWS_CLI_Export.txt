aws emr create-cluster --auto-scaling-role EMR_AutoScaling_DefaultRole --applications Name=Hadoop Name=Hive Name=Pig Name=Hue Name=Spark --ebs-root-volume-size 10 --ec2-attributes '{"InstanceProfile":"EMR_EC2_DefaultRole","SubnetId":"subnet-0b227147","EmrManagedSlaveSecurityGroup":"sg-00b3edaf321d7236a","EmrManagedMasterSecurityGroup":"sg-0a8aa62aefcffbda7"}' --service-role EMR_DefaultRole --enable-debugging --release-label emr-6.2.0 --log-uri 's3n://cs649a2/Logs/' --steps '[{"Args":["spark-submit","--deploy-mode","client","s3://cs649a2/A2_Part2.py","-i","s3://cs649a2/P00000001-ALL.csv","-o","s3://jm-output/output"],"Type":"CUSTOM_JAR","ActionOnFailure":"CONTINUE","Jar":"command-runner.jar","Properties":"","Name":"A2_Part2"},{"Args":["spark-submit","--deploy-mode","client","s3://cs649a2/A2_Part1.py","-i","s3://cs649a2/P00000001-ALL.csv","-o","s3://jm-output/output"],"Type":"CUSTOM_JAR","ActionOnFailure":"CONTINUE","Jar":"command-runner.jar","Properties":"","Name":"A2_Part1"}]' --name 'My cluster' --instance-groups '[{"InstanceCount":2,"BidPrice":"OnDemandPrice","EbsConfiguration":{"EbsBlockDeviceConfigs":[{"VolumeSpecification":{"SizeInGB":32,"VolumeType":"gp2"},"VolumesPerInstance":2}]},"InstanceGroupType":"CORE","InstanceType":"m4.xlarge","Name":"Core - 2"},{"InstanceCount":1,"BidPrice":"OnDemandPrice","EbsConfiguration":{"EbsBlockDeviceConfigs":[{"VolumeSpecification":{"SizeInGB":32,"VolumeType":"gp2"},"VolumesPerInstance":2}]},"InstanceGroupType":"MASTER","InstanceType":"m4.xlarge","Name":"Master - 1"}]' --scale-down-behavior TERMINATE_AT_TASK_COMPLETION --region us-east-2